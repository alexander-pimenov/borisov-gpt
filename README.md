# Borisov-GPT

Spring Boot ะฟัะธะปะพะถะตะฝะธะต ะดะปั ัะฐัะฐ ั ะปะพะบะฐะปัะฝะพะน LLM ัะตัะตะท Ollama ั ะฟะพะดะดะตัะถะบะพะน RAG (Retrieval-Augmented Generation) ะธ ะธััะพัะธะตะน ะดะธะฐะปะพะณะพะฒ.

## ๐ ะะฑะทะพั

ะัะพะตะบั ะฟัะตะดััะฐะฒะปัะตั ัะพะฑะพะน ััะตะฑะฝะพะต ะฟัะธะปะพะถะตะฝะธะต, ะดะตะผะพะฝัััะธััััะตะต ะธะฝัะตะณัะฐัะธั **Spring AI** ั ะปะพะบะฐะปัะฝะพะน ัะทัะบะพะฒะพะน ะผะพะดะตะปัั ัะตัะตะท **Ollama**. ะัะธะปะพะถะตะฝะธะต ะฟัะตะดะพััะฐะฒะปัะตั ะฒะตะฑ-ะธะฝัะตััะตะนั ะดะปั ัะฐัะฐ ั ะฟะพะดะดะตัะถะบะพะน:

- **ะััะพัะธะธ ะดะธะฐะปะพะณะพะฒ** โ ััะฐะฝะตะฝะธะต ะธ ะธัะฟะพะปัะทะพะฒะฐะฝะธะต ะบะพะฝัะตะบััะฐ ะฟัะตะดัะดััะธั ัะพะพะฑัะตะฝะธะน
- **RAG (Retrieval-Augmented Generation)** โ ะฟะพะธัะบ ัะตะปะตะฒะฐะฝัะฝะพะน ะธะฝัะพัะผะฐัะธะธ ะฒ ะดะพะบัะผะตะฝัะฐั ะดะปั ัะปัััะตะฝะธั ะพัะฒะตัะพะฒ
- **ะกััะธะผะธะฝะณะฐ ะพัะฒะตัะพะฒ** โ ะฟะพัะพะบะพะฒะฐั ะฟะตัะตะดะฐัะฐ ัะพะบะตะฝะพะฒ ะฟะพ ะผะตัะต ะณะตะฝะตัะฐัะธะธ (Server-Sent Events)

## ๐๏ธ ะััะธัะตะบัััะฐ

```
โโโโโโโโโโโโโโโโโโโ     โโโโโโโโโโโโโโโโโ     โโโโโโโโโโโโโโโโโโโ
โ   Spring Boot   โโโโโโถโ    Ollama     โโโโโโถโ  LLM ะะพะดะตะปั     โ
โ   Application   โ     โ   (Docker)    โ     โ  gemma3:4b-it   โ
โ   (ะฟะพัั 8181)   โ     โ   (ะฟะพัั 11431)โ     โ                 โ
โโโโโโโโโโฌโโโโโโโโโ     โโโโโโโโโโโโโโโโโ     โโโโโโโโโโโโโโโโโโโ
         โ
         โผ
โโโโโโโโโโโโโโโโโโโ
โ  PostgreSQL     โ
โ  (pgvector)     โ
โ  (ะฟะพัั 5432)    โ
โโโโโโโโโโโโโโโโโโโ
```

## ๐๏ธ ะขะตัะฝะพะปะพะณะธัะตัะบะธะน ััะตะบ

| ะขะตัะฝะพะปะพะณะธั | ะะตััะธั | ะะฐะทะฝะฐัะตะฝะธะต |
|------------|--------|------------|
| Java | 21 | ะฏะทัะบ ะฟัะพะณัะฐะผะผะธัะพะฒะฐะฝะธั |
| Spring Boot | 3.4.4 | ะคัะตะนะผะฒะพัะบ ะฟัะธะปะพะถะตะฝะธั |
| Spring AI | 1.0.0 | ะะฝัะตะณัะฐัะธั ั LLM |
| PostgreSQL | 15.8 + pgvector | ะฅัะฐะฝะตะฝะธะต ะดะฐะฝะฝัั ะธ ะฒะตะบัะพัะฝัะน ะฟะพะธัะบ |
| Ollama | latest | ะะพะบะฐะปัะฝะฐั LLM |
| Docker Compose | - | ะะพะฝัะตะนะฝะตัะธะทะฐัะธั |
| Lombok | - | ะฃะฟัะพัะตะฝะธะต ะบะพะดะฐ |
| Thymeleaf | - | ะจะฐะฑะปะพะฝะธะทะฐัะพั ะดะปั UI |

## ๐ ะัััััะน ััะฐัั

### ะัะตะดะฒะฐัะธัะตะปัะฝัะต ััะตะฑะพะฒะฐะฝะธั

- Java 21+
- Docker ะธ Docker Compose
- Maven

### ะฃััะฐะฝะพะฒะบะฐ

1. **ะะปะพะฝะธััะนัะต ัะตะฟะพะทะธัะพัะธะน:**
   ```bash
   git clone <repository-url>
   cd borisov-gpt
   ```

2. **ะะฐะฟัััะธัะต Docker-ัะตัะฒะธัั (PostgreSQL + Ollama):**
   ```bash
   cd docker-compose-for-app
   docker-compose up -d
   ```

3. **ะะฐะฟัััะธัะต ะฟัะธะปะพะถะตะฝะธะต:**
   ```bash
   mvn spring-boot:run
   ```

4. **ะัะบัะพะนัะต ะฒ ะฑัะฐัะทะตัะต:**
   ```
   http://localhost:8181
   ```

## ๐ ะกัััะบัััะฐ ะฟัะพะตะบัะฐ

```
borisov-gpt/
โโโ src/main/java/org/jeka/demowebinar1no_react/
โ   โโโ BorisovLLMApplication.java    # ะะปะฐะฒะฝัะน ะบะปะฐัั
โ   โโโ controller/
โ   โ   โโโ ChatController.java       # MVC-ะบะพะฝััะพะปะปะตั
โ   โ   โโโ StreamingChatController.java  # SSE-ัััะธะผะธะฝะณ
โ   โโโ model/
โ   โ   โโโ Chat.java                 # ะกััะฝะพััั ัะฐัะฐ
โ   โ   โโโ ChatEntry.java            # ะกััะฝะพััั ัะพะพะฑัะตะฝะธั
โ   โ   โโโ Role.java                 # ะะพะปะธ (USER/ASSISTANT/SYSTEM)
โ   โ   โโโ LoadedDocument.java       # ะะฐะณััะถะตะฝะฝัะต ะดะพะบัะผะตะฝัั
โ   โโโ repo/
โ   โ   โโโ ChatRepository.java       # ะะตะฟะพะทะธัะพัะธะน ัะฐัะพะฒ
โ   โ   โโโ DocumentRepository.java   # ะะตะฟะพะทะธัะพัะธะน ะดะพะบัะผะตะฝัะพะฒ
โ   โโโ services/
โ       โโโ ChatService.java          # ะะธะทะฝะตั-ะปะพะณะธะบะฐ
โ       โโโ PostgresChatMemory.java   # ะฅัะฐะฝะตะฝะธะต ะธััะพัะธะธ
โ       โโโ DocumentLoaderService.java # ะะฐะณััะทะบะฐ ะดะพะบัะผะตะฝัะพะฒ
โโโ src/main/resources/
โ   โโโ application.properties
โ   โโโ templates/chat.html
โ   โโโ knowledgebase/                # ะะพะบัะผะตะฝัั ะดะปั RAG
โโโ docker-compose-for-app/
โ   โโโ docker-compose.yml
โ   โโโ postgres/
โ   โโโ ollama/
โโโ pom.xml
```

## ๐ง ะะพะฝัะธะณััะฐัะธั

### application.properties

```properties
spring.application.name=Moy_LLM_Eto_ne_tvoy_LLM
server.port=8181

# Ollama
spring.ai.ollama.base-url=http://localhost:11431
spring.ai.ollama.chat.model=gemma3:4b-it-q4_K_M

# PostgreSQL
spring.datasource.url=jdbc:postgresql://localhost:5432/ragdb
spring.datasource.username=postgres
spring.datasource.password=postgres

# ะฆะธะบะปะธัะตัะบะธะต ะทะฐะฒะธัะธะผะพััะธ ะดะปั Advisors
spring.main.allow-circular-references=true
```

## ๐ง ะะพะผะฟะพะฝะตะฝัั Spring AI

### ChatClient

ะัะฝะพะฒะฝะพะน ะธะฝัะตััะตะนั ะดะปั ะฒะทะฐะธะผะพะดะตะนััะฒะธั ั LLM:

```java
@Bean
public ChatClient chatClient(ChatClient.Builder builder) {
    return builder.defaultAdvisors(getHistoryAdvisor(), getRagAdviser()).build();
}
```

### Advisors

**MessageChatMemoryAdvisor** โ ััะฐะฝะธั ะธััะพัะธั ัะฐัะฐ (ะฟะพัะปะตะดะฝะธะต 12 ัะพะพะฑัะตะฝะธะน):

```java
private Advisor getHistoryAdvisor() {
    return MessageChatMemoryAdvisor.builder(getChatMemory())
            .order(-10)
            .build();
}
```

**QuestionAnswerAdvisor (RAG)** โ ะฟะพะธัะบ ะฟะพ ะดะพะบัะผะตะฝัะฐะผ (topK=4):

```java
private Advisor getRagAdviser() {
    return QuestionAnswerAdvisor.builder(vectorStore)
            .promptTemplate(MY_PROMPT_TEMPLATE)
            .searchRequest(SearchRequest.builder().topK(4).build())
            .build();
}
```

## ๐ฆ Docker Compose

### ะกะตัะฒะธัั

| ะกะตัะฒะธั | ะะพัั | ะะฟะธัะฐะฝะธะต |
|--------|------|----------|
| PostgreSQL + pgvector | 5432 | ะฅัะฐะฝะตะฝะธะต ะดะฐะฝะฝัั ะธ ะฒะตะบัะพัะฝัะน ะฟะพะธัะบ |
| Ollama | 11431 | ะะพะบะฐะปัะฝะฐั LLM |

### ะะพะผะฐะฝะดั

```bash
# ะะฐะฟััะบ
docker-compose up -d

# ะััะฐะฝะพะฒะบะฐ
docker-compose down

# ะะพะปะฝะฐั ะพัะธััะบะฐ
docker-compose down -v

# ะะพะณะธ
docker logs -f ollama
```

## ๐ฏ ะคัะฝะบัะธะพะฝะฐะป

### 1. ะงะฐั ั ะธััะพัะธะตะน
ะกะพััะฐะฝะตะฝะธะต ะธ ะธัะฟะพะปัะทะพะฒะฐะฝะธะต ะธััะพัะธะธ ะดะธะฐะปะพะณะฐ ะฒ PostgreSQL.

### 2. RAG (Retrieval-Augmented Generation)
ะะพะธัะบ ัะตะปะตะฒะฐะฝัะฝัั ััะฐะณะผะตะฝัะพะฒ ะฒ ะดะพะบัะผะตะฝัะฐั ะธะท `knowledgebase/` ะธ ะดะพะฑะฐะฒะปะตะฝะธะต ะธั ะฒ ะบะพะฝัะตะบัั ะทะฐะฟัะพัะฐ.

### 3. ะกััะธะผะธะฝะณ (SSE)
ะะพัะพะบะพะฒะฐั ะฟะตัะตะดะฐัะฐ ะพัะฒะตัะพะฒ ะพั LLM ัะตัะตะท Server-Sent Events.

## ๐ ะะฐัะฐะผะตััั LLM

| ะะฐัะฐะผะตัั | ะะฝะฐัะตะฝะธะต | ะะฟะธัะฐะฝะธะต |
|----------|----------|----------|
| `temperature` | 0.7 | ะัะตะฐัะธะฒะฝะพััั ะพัะฒะตัะฐ |
| `top_k` | 40 | ะะพะปะธัะตััะฒะพ ัะพะบะตะฝะพะฒ ะดะปั ะฒัะฑะพัะฐ |
| `top_p` | 0.9 | ะะพัะพะณ ะฒะตัะพััะฝะพััะธ |
| `repeat_penalty` | 1.1 | ะจััะฐั ะทะฐ ะฟะพะฒัะพัะตะฝะธั |

## ๐ง ะะตัะตะฝะธะต ะฟัะพะฑะปะตะผ

### ะะตะดะปะตะฝะฝะฐั ะทะฐะณััะทะบะฐ ะผะพะดะตะปะตะน

```bash
# ะัะธััะบะฐ ะฝะตะทะฐะฒะตััะตะฝะฝะพะน ะทะฐะณััะทะบะธ
docker exec -it ollama /bin/sh
rm -rf /root/.ollama/models/blobs/*
ollama pull gemma3:4b-it-q4_K_M
```

### ะัะฟะพะปัะทะพะฒะฐะฝะธะต ะผะตะฝััะตะน ะผะพะดะตะปะธ

ะััะตะดะฐะบัะธััะนัะต `docker-compose.yml`:
```yaml
ollama pull gemma2:2b  # ะะผะตััะพ gemma3:4b
```

## ๐ ะะพะบัะผะตะฝัะฐัะธั

- [Javadoc](src/main/java) โ ะฟะพะปะฝะฐั ะดะพะบัะผะตะฝัะฐัะธั ะบะพะดะฐ
- [ะััั Udemy](https://www.udemy.com/course/spring-ai-rag/) โ ะธััะพะดะฝัะน ะผะฐัะตัะธะฐะป

## ๐ ะกััะปะบะธ

- [Spring AI](https://spring.io/projects/spring-ai)
- [Ollama](https://ollama.ai)
- [pgvector](https://github.com/pgvector/pgvector)

## ๐ ะะธัะตะฝะทะธั

ะฃัะตะฑะฝัะน ะฟัะพะตะบั ะฒ ัะฐะผะบะฐั ะบัััะฐ Udemy.
